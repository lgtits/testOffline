import{_ as L,a as H,b as q}from"./FilterBlockSide.badb062a.js";import{d as D,r as l,l as I,_ as b,m as K,o as c,e as _,q as S,aK as M,g as u,w as P,x as w,t as f,n as T,F as A,aH as C,p as k,f as F,h as W,j as J,aL as R,v as Q}from"./index.125062c9.js";import{S as p}from"./OnlineSearchServices.6a0a51e0.js";import"./QPagination.d30dffdc.js";import"./format.65fd2131.js";import"./QSelect.72862115.js";import"./QItemSection.574b5d90.js";import"./QItemLabel.e1e9f191.js";import"./QPopupProxy.c8bfa67b.js";import"./QExpansionItem.e7bc8664.js";const X=D({name:"DocumentCard",props:{uuid:{type:String,required:!0},document:{type:Object,required:!0}},setup(){const e="http://portal_api.stg.kuku.succ.work",i=l(),m=l(),n=l(!0),d=l(!0),r=t=>{t==="issue"?d.value=!0:n.value=!0},a=()=>{i.value.clientHeight>30&&(n.value=!1),m.value.clientHeight>30&&(d.value=!1)};return I(()=>{a()}),{isShowAllComponents:n,isShowAllIssues:d,components:i,issues:m,baseURL:e,showAllTags:r}}}),Y={class:"document-card"},Z={class:"document-info"},x={class:"document-source"},ee={class:"date"},te={class:"conference-name"},se={class:"tags"},oe={class:"component-tags"},ne={class:"issue-tags"};function ae(e,i,m,n,d,r){const a=K("router-link");return c(),_("div",Y,[S(a,{to:`/${e.$i18n.locale}/document/${e.document.data_key}`,class:"document-img cursor-pointer",style:M({backgroundImage:`url('${e.baseURL}/${e.document.img_path}')`,backgroundSize:"cover"})},null,8,["to","style"]),u("div",Z,[S(a,{to:`/${e.$i18n.locale}/document/${e.document.data_key}`,class:"document-title cursor-pointer"},{default:P(()=>[w(f(e.document.file),1)]),_:1},8,["to"]),u("div",x,[u("span",ee,f(e.document.date),1)]),u("div",te,f(e.$t("$i18n_conferenceName_$i18n"))+"\uFF1A"+f(e.document.conference),1)]),u("div",se,[u("div",oe,[u("div",{class:T(["tags-wrapper",{fixedHeight:!e.isShowAllComponents}]),ref:"components"},[(c(!0),_(A,null,C(e.document.componentTags,t=>(c(),k(a,{class:"component-tag",key:t.name,to:t.data_key?`/${e.$i18n.locale}/component/${t.data_key}`:""},{default:P(()=>[w(f(t.name),1)]),_:2},1032,["to"]))),128))],2),e.isShowAllComponents?F("",!0):(c(),_("div",{key:0,class:"component-tag tag__more",onClick:i[0]||(i[0]=t=>e.showAllTags("components"))}," ... "))]),u("div",ne,[u("div",{class:T(["tags-wrapper",{fixedHeight:!e.isShowAllIssues}]),ref:"issues"},[(c(!0),_(A,null,C(e.document.issueTags,t=>(c(),k(a,{class:"issue-tag",key:t.name,to:t.data_key?`/${e.$i18n.locale}/issue/${t.data_key}`:""},{default:P(()=>[w(f(t.name),1)]),_:2},1032,["to"]))),128))],2),e.isShowAllIssues?F("",!0):(c(),_("div",{key:0,class:"issue-tag tag__more",onClick:i[1]||(i[1]=t=>e.showAllTags("issue"))}," ... "))])])])}var N=b(X,[["render",ae],["__scopeId","data-v-41394d3e"]]);const re=D({name:"DocumentBlock",props:{uuid:{type:String,required:!0},documents:{type:Array,required:!0}},components:{DocumentCard:N},setup(){const e=l();return I(()=>{}),{inputText:e}}}),ue={class:"document-cards"};function le(e,i,m,n,d,r){const a=N;return c(),_("div",ue,[(c(!0),_(A,null,C(e.documents,t=>(c(),k(a,{key:t.data_key,document:t,uuid:e.uuid},null,8,["document","uuid"]))),128))])}var j=b(re,[["render",le],["__scopeId","data-v-5337ab22"]]);const ce=D({name:"DocumentPage",components:{FilterBlockSide:L,ResultSumSort:H,DocumentBlock:j,Pagination:q},setup(){const e=W(),i=J(),m=l(!1),n=R({sortRules:[],nowSort:""}),d=l(""),r=R({currentPage:1,dataPerPage:10,lastPage:15,maxPage:5}),a=R({}),t=l(""),g=l(e.name?e.name.toString():""),v=l([]),y=l(0),V=async()=>{const o=await p.getSortRules(g.value,t.value);n.sortRules=o.result,n.nowSort=o.result[0].sort_object,d.value=o.result[0].sort_name},B=async()=>{if(t.value=localStorage.getItem("uuid")||"",!t.value){i.replace({name:"index"});return}await V();const o=await p.getSearchResults(g.value,t.value,n.nowSort,r.currentPage);v.value=o.result.documents,y.value=o.result.totalAmount,r.lastPage=o.result.page.lastPage,Q.keyword=o.keyword,await U(),m.value=!0},z=async o=>{r.currentPage=o;const s=await p.getSearchResults(g.value,t.value,n.nowSort,r.currentPage,a);v.value=s.result.documents},E=async o=>{for(let h in o)a[h]=o[h];const s=await p.getSearchResults(g.value,t.value,n.nowSort,r.currentPage,a);v.value=s.result.documents,y.value=s.result.totalAmount,r.lastPage=s.result.page.lastPage},G=async o=>{n.nowSort=o;const s=await p.getSearchResults(g.value,t.value,n.nowSort,r.currentPage,a);v.value=s.result.documents,y.value=s.result.totalAmount,r.lastPage=s.result.page.lastPage},$=l([]),U=async()=>{let o=(await p.getSearchFilter("document",t.value)).result;$.value=o,$.value&&$.value.forEach(async s=>{const h=await p.getSearchFilterObject("document",s.filter_object,t.value),O=p.processFilterList(h.result);s.isTyping=!1,s.input="",s.addInput="",s.content=O,s.ogContent=O,s.isTree=!!s.content[0].layer})};return I(()=>{B()}),{filter:r,documents:v,totalAmount:y,uuid:t,sort:n,defaultSort:d,filterObjects:$,isLoaded:m,getPageResult:z,getFilterResult:E,pageInit:B,setSort:G}}}),ie={class:"documents"},de={class:"sidebar"},me={class:"content"},pe={class:"result-block"};function _e(e,i,m,n,d,r){const a=L,t=H,g=j,v=q;return c(),_("div",ie,[u("div",de,[S(a,{page:"component",onFilterResult:e.getFilterResult,onPageInit:e.pageInit,filterObjects:e.filterObjects},null,8,["onFilterResult","onPageInit","filterObjects"])]),u("div",me,[u("div",pe,[e.isLoaded?(c(),k(t,{key:0,totalAmount:e.totalAmount,sort:e.sort,defaultSort:e.defaultSort,onSetSort:e.setSort},null,8,["totalAmount","sort","defaultSort","onSetSort"])):F("",!0),S(g,{documents:e.documents,uuid:e.uuid},null,8,["documents","uuid"]),S(v,{currentPage:e.filter.currentPage,lastPage:e.filter.lastPage,onGoPage:e.getPageResult},null,8,["currentPage","lastPage","onGoPage"])])])])}var Re=b(ce,[["render",_e],["__scopeId","data-v-6313fd57"]]);export{Re as default};
